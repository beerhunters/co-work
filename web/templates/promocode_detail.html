{% extends "base.html" %}
{% block title %}
    {% if new %}
        Новый промокод
    {% elif edit %}
        Редактирование промокода
    {% else %}
        Промокод: {{ promocode.name }}
    {% endif %}
{% endblock %}
{% block content_title %}
    {% if new %}
        Новый промокод
    {% elif edit %}
        Редактирование промокода: {{ promocode.name }}
    {% else %}
        Промокод: {{ promocode.name }}
    {% endif %}
{% endblock %}
{% block content %}
<style>
    .detail-label {
        font-weight: bold;
        color: #495057;
    }
    .detail-value {
        color: #212529;
    }
    .form-control {
        font-size: 14px;
    }
    .btn-action {
        font-size: 14px;
        padding: 6px 12px;
    }
</style>
<div class="card">
    <div class="card-header">
        <h3 class="card-title">
            {% if new %}
                Создание нового промокода
            {% elif edit %}
                Редактирование промокода
            {% else %}
                Детали промокода
            {% endif %}
        </h3>
        {% if not new %}
        <div class="card-tools">
            <a href="{{ url_for('edit_promocode', promocode_id=promocode.id) }}" class="btn btn-warning btn-action">
                <i class="fas fa-edit"></i> Редактировать
            </a>
            <form action="{{ url_for('delete_promocode', promocode_id=promocode.id) }}" method="POST" style="display:inline;">
                <button type="submit" class="btn btn-danger btn-action" onclick="return confirm('Вы уверены, что хотите удалить промокод?')">
                    <i class="fas fa-trash"></i> Удалить
                </button>
            </form>
        </div>
        {% endif %}
    </div>
    <div class="card-body">
        {% if edit or new %}
        <form method="POST" action="{{ url_for('new_promocode') if new else url_for('edit_promocode', promocode_id=promocode.id) }}">
            <div class="form-group">
                <label for="name" class="detail-label">Название:</label>
                <input type="text" class="form-control" id="name" name="name" value="{{ promocode.name }}" required>
            </div>
            <div class="form-group">
                <label for="discount" class="detail-label">Скидка (%):</label>
                <input type="number" class="form-control" id="discount" name="discount" value="{{ promocode.discount }}" min="0" max="100" required>
            </div>
            <div class="form-group">
                <label for="usage_quantity" class="detail-label">Количество использований:</label>
                <input type="number" class="form-control" id="usage_quantity" name="usage_quantity" value="{{ promocode.usage_quantity }}" min="0" required>
            </div>
            <div class="form-group">
                <label for="expiration_date" class="detail-label">Дата истечения (гггг-мм-дд чч:мм):</label>
                <input type="datetime-local" class="form-control" id="expiration_date" name="expiration_date" value="{{ promocode.expiration_date.strftime('%Y-%m-%dT%H:%M') if promocode.expiration_date else '' }}">
            </div>
            <div class="form-group form-check">
                <input type="checkbox" class="form-check-input" id="is_active" name="is_active" {{ 'checked' if promocode.is_active else '' }}>
                <label class="form-check-label" for="is_active">Активен</label>
            </div>
            <button type="submit" class="btn btn-primary btn-action">
                <i class="fas fa-save"></i> Сохранить
            </button>
            <a href="{{ url_for('promocodes') }}" class="btn btn-secondary btn-action">
                <i class="fas fa-arrow-left"></i> Отмена
            </a>
        </form>
        {% else %}
        <div class="row">
            <div class="col-md-6">
                <p><span class="detail-label">ID:</span> <span class="detail-value">{{ promocode.id }}</span></p>
                <p><span class="detail-label">Название:</span> <span class="detail-value">{{ promocode.name }}</span></p>
                <p><span class="detail-label">Скидка (%):</span> <span class="detail-value">{{ promocode.discount }}</span></p>
                <p><span class="detail-label">Количество использований:</span> <span class="detail-value">{{ promocode.usage_quantity }}</span></p>                <p><span class="detail-label">Дата истечения:</span> <span class="detail-value">{{ promocode.expiration_date.strftime('%Y-%m-%d %H:%M') if promocode.expiration_date else 'Не указано' }}</span></p>
                <p><span class="detail-label">Активен:</span> <span class="detail-value">{{ '✅' if promocode.is_active else '❌' }}</span></p>
            </div>
        </div>
        <a href="{{ url_for('promocodes') }}" class="btn btn-secondary btn-action">
            <i class="fas fa-arrow-left"></i> Назад к списку
        </a>
        {% endif %}
    </div>
</div>
{% endblock %}